(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-reserve-reserve~pages-reserve-seat-reserve-seat-choose-v2"],{"26fa":function(e,t,a){"use strict";a.r(t);var r=a("8f85"),s=a("de30");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("ef8f");var i,o=a("f0c5"),d=Object(o["a"])(s["default"],r["b"],r["c"],!1,null,"0bc3a680",null,!1,r["a"],i);t["default"]=d.exports},"2e45":function(e,t,a){var r=a("24fb");t=r(!1),t.push([e.i,'@charset "UTF-8";\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */uni-button[data-v-0bc3a680]::after{border:0!important}.resource-tags[data-v-0bc3a680]{display:flex;gap:%?8?%;flex-shrink:0;opacity:.6}.resource-tags .resource-sign[data-v-0bc3a680]{display:inline-flex;justify-content:center;align-items:center;width:%?40?%;height:%?40?%;border-radius:%?8?%;font-size:%?20?%;color:#fff}.resource-tags .resource-sign.meeting[data-v-0bc3a680]{background-color:#7b67ee}.resource-tags .resource-sign.seat[data-v-0bc3a680]{background-color:#65cafd}.resource-tags .resource-sign.long[data-v-0bc3a680]{background-color:#4cd964}.seat-reserve-modal .seat-modal-header[data-v-0bc3a680]{padding:%?30?%;text-align:center;font-size:%?32?%;font-weight:700;border-bottom:1px solid #eee}.seat-reserve-modal .seat-modal-body[data-v-0bc3a680]{width:%?600?%;padding:%?30?%}.seat-reserve-modal .seat-section-title[data-v-0bc3a680]{font-size:%?32?%;font-weight:700;margin-bottom:%?20?%;color:#333}.seat-reserve-modal .seat-info[data-v-0bc3a680]{background-color:#f7f7f7;padding:%?20?%;border-radius:%?8?%;margin-bottom:%?30?%;font-size:%?26?%;color:#666}.seat-reserve-modal .seat-info-item[data-v-0bc3a680]{display:flex;align-items:center}.seat-reserve-modal .seat-info-item[data-v-0bc3a680]:not(:last-child){margin-bottom:%?10?%}.seat-reserve-modal .seat-info-label[data-v-0bc3a680]{width:%?250?%;text-align:right;flex-shrink:0;margin-right:%?20?%;font-weight:500}.seat-reserve-modal .seat-info-value[data-v-0bc3a680]{flex:1;color:#333}.seat-reserve-modal .seat-time-picker[data-v-0bc3a680]{margin-bottom:%?30?%}.seat-reserve-modal .seat-reservations-list[data-v-0bc3a680]{background-color:#f9f9f9;border-radius:%?8?%}.seat-reserve-modal .seat-empty-state[data-v-0bc3a680]{line-height:%?100?%;text-align:center;padding:%?20?%;font-size:%?28?%;color:#999}.seat-reserve-modal .seat-reservations-container[data-v-0bc3a680]{background-color:#f9f9f9;border-radius:%?8?%;padding:0 %?10?%}.seat-reserve-modal .seat-reservation-item[data-v-0bc3a680]{display:flex;justify-content:space-between;align-items:center;padding:%?15?% %?20?%;font-size:%?26?%;border-bottom:%?2?% solid #eee}.seat-reserve-modal .seat-reservation-item[data-v-0bc3a680]:first-child{padding-top:%?20?%}.seat-reserve-modal .seat-reservation-item[data-v-0bc3a680]:last-child{border-bottom:none;padding-bottom:%?20?%}.seat-reserve-modal .seat-reservation-user[data-v-0bc3a680]{color:#333;flex:1}.seat-reserve-modal .seat-reservation-time[data-v-0bc3a680]{color:#666;flex:1;text-align:center}.seat-reserve-modal .report-link[data-v-0bc3a680]{text-align:right;color:#f04a4a;font-size:%?24?%;text-decoration:underline;cursor:pointer;flex:1}.seat-reserve-modal .report-link--disabled[data-v-0bc3a680]{color:#ccc;cursor:not-allowed;text-decoration:none}.seat-reserve-modal .meeting-form .form-item[data-v-0bc3a680]{margin-bottom:%?24?%}.seat-reserve-modal .meeting-form .form-item .label[data-v-0bc3a680]{font-size:%?28?%;color:#333;margin-bottom:%?12?%}.seat-reserve-modal .meeting-form .form-item .meeting-input[data-v-0bc3a680]{width:100%;height:%?72?%;background:#f5f7fa;border-radius:%?12?%;padding:0 %?24?%;font-size:%?28?%;box-sizing:border-box}.seat-reserve-modal .meeting-form .form-item .meeting-textarea[data-v-0bc3a680]{width:100%;height:%?160?%;background:#f5f7fa;border-radius:%?12?%;padding:%?24?%;font-size:%?28?%;box-sizing:border-box}.seat-reserve-modal .meeting-form .form-item[data-v-0bc3a680]:last-child{margin-bottom:0}.seat-reserve-modal .add-attendee[data-v-0bc3a680]{display:flex;align-items:center;gap:%?16?%;margin-bottom:%?24?%}.seat-reserve-modal .add-attendee .attendee-input[data-v-0bc3a680]{flex:1;height:%?72?%;background:#f5f7fa;border-radius:%?12?%;padding:0 %?24?%;font-size:%?28?%}.seat-reserve-modal .add-attendee .add-btn[data-v-0bc3a680]{width:%?120?%;height:%?70?%;background-color:#65cafd;color:#fff;border-radius:%?8?%;font-size:%?26?%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.seat-reserve-modal .attendee-list[data-v-0bc3a680]{padding:%?15?% 0;max-height:%?400?%;background-color:#f9f9f9;border-radius:%?12?%}.seat-reserve-modal .attendee-container[data-v-0bc3a680]{height:%?300?%;padding:0 %?10?%}.seat-reserve-modal .attendee-item[data-v-0bc3a680]{display:flex;justify-content:space-between;align-items:center;padding:%?15?% %?20?%;font-size:%?26?%;border-bottom:%?2?% solid #eee}.seat-reserve-modal .attendee-item[data-v-0bc3a680]:first-child{padding-top:%?20?%}.seat-reserve-modal .attendee-item[data-v-0bc3a680]:last-child{border-bottom:none;padding-bottom:%?20?%}.seat-reserve-modal .attendee-user[data-v-0bc3a680]{color:#333;flex:1}.seat-reserve-modal .attendee-code[data-v-0bc3a680]{color:#666;flex:1}.seat-reserve-modal .attendee-delete[data-v-0bc3a680]{flex:1;text-align:right}.seat-reserve-modal .attendee-delete .attendee-delete-icon[data-v-0bc3a680]{width:%?45?%;height:%?45?%;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.seat-reserve-modal .material-form[data-v-0bc3a680]{margin-bottom:%?40?%}.seat-reserve-modal .material-form .form-item[data-v-0bc3a680]{margin-bottom:%?24?%}.seat-reserve-modal .material-form .form-item .form-item-label[data-v-0bc3a680]{font-size:%?28?%;color:#333;margin-bottom:%?12?%}.seat-reserve-modal .material-form .form-item .form-item-content-input[data-v-0bc3a680]{background:#f5f7fa;border-radius:%?12?%;padding:0 %?24?%;font-size:%?28?%;height:%?72?%}.seat-reserve-modal .seat-modal-footer[data-v-0bc3a680]{padding:%?30?%}.seat-reserve-modal .seat-btn-actions[data-v-0bc3a680]{display:flex;justify-content:space-between;gap:%?20?%}.seat-reserve-modal .seat-btn[data-v-0bc3a680]{flex:1;height:%?80?%;line-height:%?80?%;text-align:center;border-radius:%?8?%;font-size:%?28?%}.seat-reserve-modal .seat-btn.seat-btn-primary[data-v-0bc3a680]{background-color:#65cafd;color:#fff}.seat-reserve-modal .seat-btn.seat-btn-cancel[data-v-0bc3a680]{background-color:#f5f5f5;color:#666}',""]),e.exports=t},4477:function(e,t,a){"use strict";a("7a82");var r=a("ee27").default;Object.defineProperty(t,"__esModule",{value:!0}),t.createReport=i,t.getReportCount=d,t.getReportDetail=o;var s=r(a("408b")),n=a("8982");function i(e){return(0,n.request)(s.default.report.createReport(e))}function o(e){return(0,n.request)(s.default.report.getReportDetail(e))}function d(e){return(0,n.request)(s.default.report.getReportCount(e))}},7616:function(e,t,a){"use strict";a("7a82");var r=a("ee27").default;Object.defineProperty(t,"__esModule",{value:!0}),t.backSeat=u,t.cancelSeat=f,t.cancelSeatApplication=o,t.changeSeat=p,t.checkInSeat=l,t.createLongTermSeatApplication=d,t.createSeatApplication=i,t.finishSeat=v,t.getSeatReservationPage=b,t.getSeatReservationsByDate=x,t.getSeatTodayReservations=R,t.getSeatWithReservation=w,t.leaveSeat=c,t.longTermCheckIn=m,t.longTermCheckOut=g,t.longTermRenew=h;var s=r(a("408b")),n=a("8982");function i(e){return(0,n.request)(s.default.reading.createSeatApplication(e))}function o(e){return(0,n.request)(s.default.reading.cancelSeatApplication(e))}function d(e){return(0,n.request)(s.default.reading.createLongTermSeatApplication(e))}function l(e){return(0,n.request)(s.default.reading.checkInSeat(e))}function c(e){return(0,n.request)(s.default.reading.leaveSeat(e))}function u(e){return(0,n.request)(s.default.reading.backSeat(e))}function v(e){return(0,n.request)(s.default.reading.finishSeat(e))}function f(e){return(0,n.request)(s.default.reading.cancelSeat(e))}function m(e){return(0,n.request)(s.default.reading.longTermCheckIn(e))}function g(e,t){return(0,n.request)(s.default.reading.longTermCheckOut(e,t),"application/x-www-form-urlencoded")}function b(e,t){return(0,n.request)(s.default.reading.getSeatReservationPage(e,t))}function p(e){return(0,n.request)(s.default.reading.changeSeat(e))}function h(e){return(0,n.request)(s.default.reading.longTermRenew(e))}function R(e){return(0,n.request)(s.default.reading.getSeatTodayReservations(e))}function x(e,t){return(0,n.request)(s.default.reading.getSeatReservationsByDate(e,t))}function w(e){return(0,n.request)(s.default.reading.getSeatWithReservation(e))}},"8c19":function(e,t,a){var r=a("2e45");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var s=a("4f06").default;s("6ef49d99",r,!0,{sourceMap:!1,shadowMode:!1})},"8f85":function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return r}));var r={eModal:a("1755").default},s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("e-modal",{staticClass:"seat-reserve-modal",attrs:{visible:e.visible},on:{"update:visible":function(t){arguments[0]=t=e.$handleEvent(t),e.$emit("update:visible",t)},cancle:function(t){arguments[0]=t=e.$handleEvent(t),e.$emit("cancel")}}},[a("v-uni-view",{staticClass:"seat-modal-header"},[e._v(e._s(e.$t("reserve.seatReserveModal.title")))]),a("v-uni-view",{staticClass:"seat-modal-body"},[a("v-uni-view",{staticClass:"pick-step"},[a("v-uni-view",{staticClass:"seat-info-section"},[a("v-uni-view",{staticClass:"seat-section-title"},[e._v(e._s(e.$t("reserve.seatReserveModal.seatInfo")))]),e.seat.id?a("v-uni-view",{staticClass:"seat-info"},[a("v-uni-view",{staticClass:"seat-info-item"},[a("v-uni-text",{staticClass:"seat-info-label"},[e._v(e._s(e.$t("reserve.seatReserveModal.seatName")))]),a("v-uni-text",{staticClass:"seat-info-value"},[e._v(e._s(e.seat.name))])],1),a("v-uni-view",{staticClass:"seat-info-item"},[a("v-uni-text",{staticClass:"seat-info-label"},[e._v(e._s(e.$t("reserve.seatReserveModal.openTime")))]),a("v-uni-text",{staticClass:"seat-info-value"},[e._v(e._s(e.openCloseTime))])],1),a("v-uni-view",{staticClass:"seat-info-item"},[a("v-uni-text",{staticClass:"seat-info-label"},[e._v(e._s(e.$t("reserve.seatReserveModal.minMaxDuration")))]),a("v-uni-text",{staticClass:"seat-info-value"},[e._v(e._s(e.minMaxDuration))])],1),a("v-uni-view",{staticClass:"seat-info-item"},[a("v-uni-text",{staticClass:"seat-info-label"},[e._v(e._s(e.$t("reserve.seatReserveModal.advanceDays")))]),a("v-uni-text",{staticClass:"seat-info-value"},[e._v(e._s(e.advanceDays))])],1),a("v-uni-view",{staticClass:"seat-info-item"},[a("v-uni-text",{staticClass:"seat-info-label"},[e._v(e._s(e.$t("reserve.seatReserveModal.customStartTime")))]),a("v-uni-text",{staticClass:"seat-info-value"},[e._v(e._s(e.rule.customStartTime?e.$t("reserve.seatReserveModal.yes"):e.$t("reserve.seatReserveModal.no")))])],1),a("v-uni-view",{staticClass:"seat-info-item"},[a("v-uni-text",{staticClass:"seat-info-label"},[e._v(e._s(e.$t("reserve.seatReserveModal.needApproval")))]),a("v-uni-text",{staticClass:"seat-info-value"},[e._v(e._s(e.rule.needApproval?e.$t("reserve.seatReserveModal.yes"):e.$t("reserve.seatReserveModal.no")))])],1)],1):e._e()],1),a("v-uni-view",{staticClass:"seat-time-section"},[a("v-uni-view",{staticClass:"seat-section-title"},[e._v(e._s(e.$t("reserve.seatReserveModal.selectTime")))]),a("v-uni-view",{staticClass:"seat-time-picker"},[a("reservation-range-picker",{attrs:{rule:e.rangePickerRule},on:{"change-date":function(t){arguments[0]=t=e.$handleEvent(t),e.getSeatReservations.apply(void 0,arguments)}},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}})],1)],1),a("v-uni-view",{staticClass:"seat-reservations-section"},[a("v-uni-view",{staticClass:"seat-section-title"},[e._v(e._s(e.$t("reserve.seatReserveModal.todayReservations")))]),a("v-uni-view",{staticClass:"seat-reservations-list"},[0===e.reservations.length?a("v-uni-view",{staticClass:"seat-empty-state"},[e._v(e._s(e.$t("reserve.seatReserveModal.noReservations")))]):a("v-uni-view",{staticClass:"seat-reservations-container"},e._l(e.reservations,(function(t){return a("v-uni-view",{key:t.id,staticClass:"seat-reservation-item"},[a("v-uni-text",{staticClass:"seat-reservation-user"},[e._v(e._s(t.user))]),a("v-uni-text",{staticClass:"seat-reservation-time"},[e._v(e._s(t.time))]),a("v-uni-text",{staticClass:"report-link",class:{"report-link--disabled":"IN_USE"!==t.status||t.userId===e.userInfo.id},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.goToReport(t)}}},[e._v(e._s(e.$t("reserve.scanSeatModal.report")))])],1)})),1)],1)],1)],1)],1),a("v-uni-view",{staticClass:"seat-modal-footer"},[a("v-uni-view",{staticClass:"seat-btn-actions"},[a("v-uni-button",{staticClass:"seat-btn seat-btn-cancel",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.handleCancel.apply(void 0,arguments)}}},[e._v(e._s(e.$t("reserve.seatReserveModal.cancel")))]),a("v-uni-button",{staticClass:"seat-btn seat-btn-primary",attrs:{loading:e.loading,disabled:e.loading},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v(e._s(e.use?e.$t("reserve.seatReserveModal.use"):e.$t("reserve.seatReserveModal.reserve")))])],1)],1)],1)},n=[]},b904:function(e,t,a){"use strict";a("7a82");var r=a("ee27").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(a("f07e")),n=r(a("c964")),i=r(a("f3f3"));a("99af"),a("4de4"),a("d3b7"),a("14d9");var o=r(a("5a0c")),d=r(a("e418")),l=r(a("f906")),c=r(a("f335")),u=a("7616"),v=a("4477");o.default.extend(l.default),o.default.extend(d.default);var f={name:"MeetingReserveModal",components:{ReservationRangePicker:c.default},props:{visible:{type:Boolean,default:!1},seat:{type:Object,default:function(){return{}}},scan:{type:Boolean,default:!1},defaultTimeRange:{type:Object,default:function(){var e=(0,o.default)();return{date:e.format("YYYY-MM-DD"),startTime:e.format("HH:mm"),endTime:e.hour(22).minute(0).format("HH:mm")}}}},data:function(){return{timeRange:this.defaultTimeRange,reservations:[],loading:!1}},computed:{userInfo:function(){return uni.getStorageSync("info")},rule:function(){return this.seat.rule},openCloseTime:function(){return"".concat(this.seat.openTime," - ").concat(this.seat.closeTime)},minMaxDuration:function(){var e=this.rule.minDurationMinutes?this.rule.minDurationMinutes:"无限制",t=this.rule.maxDurationMinutes?this.rule.maxDurationMinutes:"无限制";return"".concat(e,"/").concat(t)},advanceDays:function(){return this.rule.advanceReservationDays?"".concat(this.rule.advanceReservationDays," ").concat(this.$t("reserve.seatReserveModal.days")):this.$t("reserve.seatReserveModal.noAdvanceReservation")},rangePickerRule:function(){return(0,i.default)((0,i.default)({},this.rule),{},{openTime:this.seat.openTime,closeTime:this.seat.closeTime})},hasTimeIntersection:function(){var e=(0,o.default)(),t=(0,o.default)("".concat(this.timeRange.date," ").concat(this.timeRange.startTime)),a=(0,o.default)("".concat(this.timeRange.date," ").concat(this.timeRange.endTime));return e.isBetween(t,a,null,"[]")},use:function(){var e;return this.hasTimeIntersection&&!(null!==(e=this.rule)&&void 0!==e&&e.needApproval)&&this.scan}},watch:{visible:function(e){e&&(this.timeRange=this.defaultTimeRange,this.getSeatReservations())}},methods:{getSeatReservations:function(){var e=this;return(0,n.default)((0,s.default)().mark((function t(){var a,r,n;return(0,s.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={date:e.timeRange.date},r=(0,o.default)(),t.next=4,(0,u.getSeatReservationsByDate)(e.seat.id,a);case 4:n=t.sent,e.reservations=n.filter((function(e){return(0,o.default)(e.endTime).isAfter(r)}));case 6:case"end":return t.stop()}}),t)})))()},handleCancel:function(){this.$emit("update:visible",!1)},submit:function(){var e=this;return(0,n.default)((0,s.default)().mark((function t(){var a,r,n,i,d,l,c;return(0,s.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.loading){t.next=2;break}return t.abrupt("return");case 2:if(a=(0,o.default)("".concat(e.timeRange.date),"YYYY-MM-DD"),r=(0,o.default)(),!a.isAfter(r,"day")){t.next=11;break}if(n=(0,o.default)(e.seat.rule.availableStartTime,"HH:mm"),i=(0,o.default)(e.seat.rule.availableEndTime,"HH:mm"),d=r.isBetween(n,i,null,"[]"),d){t.next=11;break}return e.$toast(e.$t("reserve.outOfAvailableTime",{startTime:n.format("HH:mm"),endTime:i.format("HH:mm")})),t.abrupt("return");case 11:if(e.validateTime()){t.next=13;break}return t.abrupt("return");case 13:return e.loading=!0,t.prev=14,l={seatId:e.seat.id,startTime:"".concat(e.timeRange.date," ").concat(e.timeRange.startTime),endTime:"".concat(e.timeRange.date," ").concat(e.timeRange.endTime),needMaterial:!1,use:e.use},t.next=18,(0,u.createSeatApplication)(l);case 18:c=e.rule.needApproval?e.$t("reserve.applicationSubmittedMessage"):e.$t("reserve.reservationSuccessfulMessage"),uni.showToast({title:c,icon:"none"}),e.$emit("update:visible",!1),e.$emit("submit");case 22:return t.prev=22,e.loading=!1,t.finish(22);case 25:case"end":return t.stop()}}),t,null,[[14,,22,25]])})))()},validateTime:function(){var e="".concat(this.timeRange.date," ").concat(this.timeRange.startTime),t="".concat(this.timeRange.date," ").concat(this.timeRange.endTime),a=(0,o.default)(e),r=(0,o.default)(t);if(a.isAfter(r)||a.isSame(r))return uni.showToast({title:this.$t("reserve.seatReserveModal.endTimeNotEarlierThanStart"),icon:"none"}),!1;var s=r.diff(a,"minute");return this.rule.minDurationMinutes>0&&s<this.rule.minDurationMinutes?(uni.showToast({title:this.$t("reserve.seatReserveModal.durationTooShort",{minutes:this.rule.minDurationMinutes}),icon:"none"}),!1):!(this.rule.maxDurationMinutes>0&&s>this.rule.maxDurationMinutes)||(uni.showToast({title:this.$t("reserve.seatReserveModal.durationTooLong",{minutes:this.rule.maxDurationMinutes}),icon:"none"}),!1)},goToReport:function(e){var t=this;return(0,n.default)((0,s.default)().mark((function a(){var r,n,i;return(0,s.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("IN_USE"===e.status){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,a.next=5,(0,v.getReportCount)(e.userId);case 5:if(r=a.sent,n=r.userReportCount,i=r.reportedUserReportedCount,!(n>=3)){a.next=11;break}return uni.showToast({title:t.$t("reserve.scanSeatModal.maxReportReached"),icon:"none"}),a.abrupt("return");case 11:if(!(i>=3)){a.next=14;break}return uni.showToast({title:t.$t("reserve.scanSeatModal.targetMaxReportReached"),icon:"none"}),a.abrupt("return");case 14:t.$Router.push({name:"user-report-create",params:{resourceId:t.seat.id,resourceType:"SEAT",resourceName:t.seat.name,parentNamePath:t.seat.parentNamePath,reservationId:e.reservationId}}),a.next=20;break;case 17:a.prev=17,a.t0=a["catch"](2),uni.showToast({title:t.$t("reserve.seatReserveModal.operationFailed"),icon:"none"});case 20:case"end":return a.stop()}}),a,null,[[2,17]])})))()}}};t.default=f},de30:function(e,t,a){"use strict";a.r(t);var r=a("b904"),s=a.n(r);for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);t["default"]=s.a},ef8f:function(e,t,a){"use strict";var r=a("8c19"),s=a.n(r);s.a}}]);